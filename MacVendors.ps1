if($response -ne $null) {clear-variable response}
$Macs = @(
"001b.1700.1910",
"001b.1700.1912",
"001b.1700.1913",
"001b.1700.1914",
"001b.1700.1915",
"0c75.bd93.7811",
"00a0.26ce.a9b6",
"0004.1378.57e6",
"000c.2924.ad5d",
"000c.2928.936b",
"000c.29c7.973d",
"000c.29e5.6ef8",
"000f.7c05.addf",
"0011.328f.f3b8",
"0011.328f.f3b9",
"0013.3b0f.a34a",
"001b.1700.1910",
"0024.8121.35a8",
"0040.9daf.0b8d",
"0040.9db2.6c81",
"0040.9db2.6cdc",
"0040.9db2.6ce4",
"0050.568c.143f",
"0080.c83c.af15",
"00a0.ba0c.9005",
"00b0.192c.5d07",
"00c0.ff44.6610",
"00c0.ff44.66a2",
"00e0.4b24.c39e",
"040e.3c8d.c25c",
"084f.a9b6.fe22",
"08f1.ea78.1c40",
"10e7.c605.ce63",
"1860.2424.6b75",
"1860.2424.b82a",
"18a9.052d.df34",
"308d.9914.3878",
"5803.fb06.071e",
"5838.791d.2004",
"5838.7938.5c49",
"6c4b.9085.7229",
"7cd3.0a1c.651d",
"80ce.625d.f992",
"80e8.2c11.29c3",
"8439.be6b.e4f6",
"84a9.3e0e.5237",
"a4ba.db95.30ad",
"c424.5671.8900",
"d89e.f393.0e53",
"ec8e.b57b.5f98",
"f80d.ac22.7d7b",
"00a0.ba0c.9005",
"413.785.742",
"5838.7938.5c49",
"413.785.811",
"413.785.852",
"0024.9b1a.d224",
"c424.5671.8900",
"2863.3684.c274",
"0080.c83c.af15",
"7cd3.0a1c.651d",
"08f1.ea78.3c6c",
"000c.29c7.973d",
"0050.568c.143f",
"000c.29e5.6ef8",
"08f1.ea78.1c40",
"6c4b.9085.7229",
"0004.1378.581f",
"413.785.834",
"e4e7.4936.721a",
"5838.791d.2004",
"0004.1378.584f",
"413.785.824",
"10e7.c605.ce63",
"084f.a9b6.fe22",
"413.785.823",
"c424.5671.dc00",
"0004.1378.57ea",
"0004.1378.57e6",
"e4e7.494c.2b3c",
"413.785.820",
"0013.3b0f.a34a",
"001b.1700.1913",
"0024.8121.35a8",
"2829.8623.55ba",
"00e0.4b24.c39e",
"80e8.2c11.29c3",
"1860.2424.b82a",
"ace2.d304.d088",
"2829.8623.55ba",
"d89e.f393.0e53",
"308d.9914.3878",
"a4ba.db95.30ad",
"18a9.052d.df34",
"0001.0507.6e55",
"80ce.625d.f992",
"84a9.3e0e.5237",
"f80d.ac22.7d7b",
"040e.3c8d.c25c",
"ec8e.b57b.5f98",
"1860.2424.6b75",
"8439.be6b.e4f6",
"000f.7c05.addf",
"5803.fb06.071e",
"0011.328f.f3b9",
"4c71.0c33.6607",
"5c71.0d04.d40a",
"88f0.3168.60f4",
"084f.a9fd.be74",
"0040.9da2.83c2",
"0011.328f.f3b8",
"0040.9dad.2b15",
"0040.9db2.6ce4",
"0040.9db2.6c81",
"0040.9db2.6cdc",
"0040.9daf.0b8d",
"0004.1378.57e2",
"1860.2424.6cfb",
"00b0.192c.5d07",
"0000.0c07.ac0a",
"00a0.26ce.a9b6",
"00c0.ff44.66a2",
"00c0.ff44.6610",
"000c.2924.ad5d",
"000c.2928.936b",
"000c.29bf.b87c",
"08f1.ea6e.64bc",
"0050.5668.11a5",
"0050.5665.045d",
"00c0.ff4c.dfc4",
"00c0.ff4c.e07d",
"00c0.ff4c.dfc5",
"00c0.ff4c.e07c"
)

$prefix = "$(get-date -f yyyyMMdd-HHmm)";
$outFile = "${prefix}_MacAddressReport.csv"
$Path = get-location
[System.Windows.MessageBox]::Show("File created: $path$outFile")
Add-Content -Value "Mac Address;Vendor"-Path $outFile

foreach ($Mac in $Macs) {
    $response404 = try { $response=(Invoke-WebRequest -Uri "https://api.macvendors.com/$Mac").content  } catch {$_.Exception.Response.StatusCode.Value__}

    If ( $response404 -eq "404")
   {
    Write-Host "Server returned null"
    $Properties404 = $Mac + ";" + $Response404
    Add-Content -Value $Properties404 -Path $outFile
   }

   Else 
   {
    Write-Host "$Mac - $response"
        
    $Properties = $Mac + ";" + $Response
    Add-Content -Value $Properties -Path $outFile
   }
   Start-Sleep -s 1
}